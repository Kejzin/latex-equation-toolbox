{"version":3,"sources":["webpack:///./components/ImageExport/style.sass?b786","webpack:///./components/ImageExport/index.tsx"],"names":[],"mappings":";;;;;AAAA;AACA,kBAAkB,+H;;;;;;;;;;;;;;;;;;;;ACDmB;AACA;AAEG;AACa;AAErD,IAAI,KAAK,GAAG,mBAAO,CAAC,MAAc,CAAC;AACnC,IAAI,SAAS,GAAG,mBAAO,CAAC,MAAuB,CAAC;AAiBhD,IAAqB,WAAW,GAAhC,iBAAiC,SAAQ,iDAAyB;IAJlE;;QAME,aAAQ,GAAG,EAAE;QACb,kBAAa,GAAG,SAAS;IA0D3B,CAAC;IAxDC,WAAW;QAET,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,KAAK,IAAI,CAAC,QAAQ,EAAE;YACtC,OAAM;SACP;QAED,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ;QAElC,IAAI,YAAY,GAAG,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;YACzC,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC;QAC1B,CAAC,CAAC;QACF,IAAI,CAAC,aAAa,GAAG,YAAY;QAEjC,IAAI,IAAI,GAAG,IAAI;QAEf;YACE,uEAAU,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;gBACzB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,UAAU,MAAM;oBACvC,QAAQ,CAAC,uEAAO,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC;oBACrE,2DAA2D;gBAC7D,CAAC,CAAC;YACJ,CAAC,CAAC;QACJ,CAAC;QAED,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;YACtB,IAAI,YAAY,KAAK,IAAI,CAAC,aAAa,EAAE;gBACvC,UAAU,EAAE;aACb;QACH,CAAC,CAAC;IAGJ,CAAC;IAED,MAAM,CAAC,KAAK;QACV,IAAI,CAAC,WAAW,EAAE;QAElB,IAAI,OAAO,GAAG,4BAA4B,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;QAE7G,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK;QAChC,OAAO,CACL,2DAAK,SAAS,EAAE,KAAK,CAAC,SAAS;YAC7B,2DAAK,SAAS,EAAE,KAAK,CAAC,SAAS;gBAC7B,0DAAI,SAAS,EAAE,KAAK,CAAC,KAAK,wBAAwB;;gBAC0B,6DAAM;gBAAA,6DAAM;;gBACrF,6DAAM;gBACT,2DAAK,SAAS,EAAE,SAAS,CAAC,IAAI;oBAC5B,2DAAK,GAAG,EAAE,KAAK,CAAC,WAAW,CAAC,OAAO,GAAI,CACnC;gBAAA,6DAAM;;gBACT,6DAAM;gBACT,2DAAK,SAAS,EAAE,SAAS,CAAC,IAAI;oBAC5B,2DAAK,GAAG,EAAE,KAAK,CAAC,WAAW,CAAC,GAAG,GAAI,CAC/B,CACF,CACF,CACP;IACH,CAAC;CACF;AA7DoB,WAAW;IAJ/B,oEAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QACjB,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,KAAK;QACxB,WAAW,EAAE,KAAK,CAAC,WAAW;KAC/B,CAAC,CAAC;GACkB,WAAW,CA6D/B;+DA7DoB,WAAW","file":"5.chunk.ae1c6.js","sourcesContent":["// removed by extract-text-webpack-plugin\nmodule.exports = {\"mathBackground\":\"mathBackground__3DwWi\",\"container\":\"container__drWZf\",\"scrollBox\":\"scrollBox__3TPkK\",\"title\":\"title__2gSTX\"};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/ImageExport/style.sass\n// module id = BMbX\n// module chunks = 5","import { h, Component } from 'preact'\nimport { connect } from 'react-redux'\n\nimport loadMj2img from './mathjax-setup'\nimport { actions } from '../../reducers/image-export'\n\nlet style = require('./style.sass')\nlet mathStyle = require('../Preview/style.sass')\n\ninterface PropsType {\n  latex: string,\n  dispatch(action: any)\n}\n\ndeclare global {\n  interface window {\n    MathJax: any\n  }\n}\n\n@connect(store => ({\n  latex: store.input.latex,\n  imageExport: store.imageExport\n}))\nexport default class ImageExport extends Component<PropsType, any> {\n\n  oldLatex = ''\n  newestPromise = undefined\n\n  generatePNG() {\n\n    if (this.props.latex === this.oldLatex) {\n      return\n    }\n\n    let dispatch = this.props.dispatch\n\n    let localPromise = new Promise((resolve) => {\n      setTimeout(resolve, 400)\n    })\n    this.newestPromise = localPromise\n\n    let self = this\n\n    function updateMath() {\n      loadMj2img().then(mj2img => {\n        mj2img(self.props.latex, function (output) {\n          dispatch(actions.updateImage(output.img, output.svg, output.svgData))\n          //document.getElementById(\"target\").innerHTML = output.svg;\n        })\n      })\n    }\n\n    localPromise.then(res => {\n      if (localPromise === self.newestPromise) {\n        updateMath()\n      }\n    })\n\n\n  }\n\n  render(props) {\n    this.generatePNG()\n\n    let svgData = 'data:image/svg+xml;base64,' + window.btoa(unescape(encodeURIComponent(props.imageExport.svg)))\n\n    this.oldLatex = this.props.latex\n    return (\n      <div className={style.scrollBox}>\n        <div className={style.container}>\n          <h2 className={style.title}>Image export view</h2>\n          You can drag and drop the images below, into other applications or a folder.<br /><br />\n          SVG<br />\n          <div className={mathStyle.math}>\n            <img src={props.imageExport.svgData} />\n          </div><br />\n          PNG<br />\n          <div className={mathStyle.math}>\n            <img src={props.imageExport.png} />\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./components/ImageExport/index.tsx"],"sourceRoot":""}